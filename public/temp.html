<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekap Data K3 JAGORAWI</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f0f2f5;
            font-family: Arial, sans-serif;
        }
    
        .container {
            margin-top: 20px;
        }
    
        /* Custom navbar styles */
        .navbar-custom {
            background-color: #FFD700; /* Kuning */
            border-radius: 10px; /* Add rounded corners to navbar */
            padding: 10px 20px; /* Add padding for a better look */
        }
    
        .navbar-custom .nav-link {
            color: #0056b3; /* Biru */
            font-weight: bold;
            border-radius: 5px; /* Round the navbar items */
            padding: 10px 15px; /* Add padding to navbar items */
            transition: background-color 0.3s; /* Smooth transition for hover effect */
        }
    
        .navbar-custom .nav-link:hover {
            color: #fff; /* Change text color on hover */
            background-color: #003c82; /* Background color on hover */
        }
    
        .navbar-custom .navbar-brand {
            color: #0056b3; /* Biru */
            font-weight: bold;
            border-radius: 5px; /* Round the brand item */
        }
    
        .navbar-custom .navbar-brand:hover {
            color: #fff; /* Change color on hover */
        }
    
        /* Custom button styles */
        .btn-custom {
            background-color: hwb(210 35% 16%);
            color: #fff;
            border: none;
            font-weight: bold;
            border-radius: 5px; /* Round the custom buttons */
            padding: 10px 15px; /* Add padding to buttons */
        }
    
        .btn-custom:hover {
            background-color: #003c82;
        }
    
        .navbar-toggler {
            border-color: #fff;
            border-radius: 5px; /* Round the toggle button */
        }
    
        /* Logo */
        .navbar-brand img {
            height: 60px;
            width: auto;
        }
    
        /* Custom table header styles */
        table thead th {
            background-color: #0056b3;
            color: white;
            text-align: center;
        }
    
        table tbody td {
            text-align: center;
        }
    
        /* Custom export button styles */
        #export-button, #export-buttonPersonel, #export-buttonKecelakaan,
        #export-buttonKejadian {
            background-color: #FFD700;
            color: #0056b3;
            font-weight: bold;
            border-radius: 5px; /* Round export buttons */
            padding: 10px 15px; /* Add padding to export buttons */
        }
    
        #export-button:hover, #export-buttonPersonel:hover, #export-buttonKecelakaan:hover,
        #export-buttonKejadian:hover {
            background-color: #ffcc00;
        }
    
    </style>
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-custom">
        <a class="navbar-brand" href="#">
            <img src="jasamarga_cover-removebg-preview.png" alt="Logo Perusahaan"> <!-- Logo Perusahaan -->
            
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#rekapData">Rekap Data K3</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#personelK3Data">Personel K3</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#kecelakaanKerja">Kecelakaan Kerja</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#kejadiannKerja">Kejadian Darurat</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link btn btn-custom" href="/index.html">Log Out</a>
                </li>
            </ul>
        </div>
    </nav>
    <!-- End of Navbar -->


    <div class="container-fluid">
        <!-- Rekap Data K3 Table -->
         <h1> </h1>
        <h2 id="rekapData" class="text-center">Rekap Data K3 JAGORAWI</h2>
        <div class="mb-4 text-center">
            <!-- Button to navigate to Add Data Page -->
            <a href="/add-data-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
            <!-- Button to navigate to Update Data Page -->
            <a href="/update-data-jagorawi.html" class="btn btn-warning">Update Data</a>
            <!-- Button to show delete modal -->
            <button class="btn btn-danger" onclick="showDeleteModalData()">Hapus Data</button>
            <button class="btn btn-success" id="export-button">Export to Excel</button>
        </div>
    
        <!-- Modal Konfirmasi Hapus -->
        <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabel">Konfirmasi Penghapusan</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Apakah Anda yakin ingin menghapus data ini?
                        <form id="deleteForm">
                            <div class="form-group">
                                <label for="no">Masukkan ID/No data:</label>
                                <input type="number" class="form-control" id="no" placeholder="Masukkan ID atau No data yang ingin dihapus">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                        <button type="button" class="btn btn-danger" onclick="deleteData()">Hapus</button>
                    </div>
                </div>
            </div>
        </div>
    
        <table id="data-table" class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                    <th rowspan="2">No</th>
                    <th rowspan="2">Bulan</th>
                    <th colspan="2">Jumlah Karyawan</th>
                    <th colspan="2">Jumlah Hari Kerja</th>
                    <th rowspan="2">Jumlah Jam Kerja</th>
                    <th colspan="2">Kecelakaan Berat</th>
                    <th colspan="2">Kecelakaan Ringan</th>
                    <th colspan="2">Kecelakaan Meninggal</th>
                    <th colspan="2">Near Miss</th>
                    <th rowspan="2">Fire Accident</th>
                    <th rowspan="2">Damaged Property</th>
                    <th colspan="2">Jumlah Hari Hilang</th>
                    <th colspan="2">Jumlah Hari Tanpa Hilang</th>
                    <th colspan="2">LTI</th>
                    <th colspan="2">Man Hour</th>
                    <th rowspan="2">Frequency Rate (FR)</th>
                </tr>
                <tr>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data tabel akan diisi oleh script.js -->
            </tbody>
        </table>
    
        <!-- Keterangan setelah tabel -->
        <div class="keterangan">
            <h4>Keterangan:</h4>
            <ul>
                <li><strong>Jumlah Hari Kerja</strong> adalah Jumlah Hari Kerja Efektif dalam 1 bulan tidak termasuk libur
                    <ul>
                        <li>Jika hari kerja Karyawan Operasional dan Non Operasional berbeda, bisa dihitung rata-ratanya.</li>
                    </ul>
                </li>
                <li><strong>Kehilangan waktu kerja</strong> dimana tenaga kerja tidak mampu bekerja kembali pada shift normal berikutnya sesuai jadwal kerja.
                    <ul>
                        <li>Perhitungan keseluruhan jam kerja dimulai sejak terjadinya kecelakaan kerja (insiden) yang dapat mengakibatkan angka perhitungan jam kerja menjadi 0 (nol) yaitu kriteria kecelakaan kerja yang menghilangkan waktu kerja, dan bertambah secara kumulatif sesuai jam kerja yang dicapai.</li>
                        <li>Perhitungan jam kerja keseluruhan meliputi semua jam kerja nyata tenaga kerja yang melaksanakan kegiatan perusahaan pada masing-masing bidang pekerjaan.</li>
                    </ul>
                </li>
            </ul>
        </div>
    
    


        <!-- Personel K3 Data Table -->
        <h2 id="personelK3Data" class="text-center">Rekap Personel K3 JAGORAWI</h2>
        <div class="mb-4 text-center">
            <a href="/add-personel-k3-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
            <a href="/update-personel-k3-jagorawi.html" class="btn btn-warning">Update Data</a>
            <button class="btn btn-danger" onclick="showDeleteModalPersonel()">Hapus Data</button>
            <button class="btn btn-success" id="export-buttonPersonel" class="btn btn-primary mb-3">Export to Excel</button>
        </div>

        <!-- Modal Konfirmasi Hapus -->
        <div class="modal fade" id="deleteModalPersonel" tabindex="-1" aria-labelledby="deleteModalLabelPersonel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabelPersonel">Konfirmasi Penghapusan</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                    </div>
            <div class="modal-body">
                Apakah Anda yakin ingin menghapus data ini?
                <form id="deleteForm">
                    <div class="form-group">
                        <label for="personel_k3_id">Masukkan ID/No data:</label>
                        <input type="number" class="form-control" id="personel_k3_id" placeholder="Masukkan ID atau No data yang ingin dihapus">
                    </div>
                </form>
            </div>
                    <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-danger" onclick="deletePersonel()">Hapus</button>
                    </div>
                </div>
            </div>
        </div>


        <table id="personel-k3-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Nama</th>
                    <th>Role</th>
                    <th>Batas Masa Berlaku</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <!-- Rekap Data Kecelakaan Kerja Table -->
        <h2 id="kecelakaanKerja" class="text-center">Rekap Data Kecelakaan Kerja JAGORAWI</h2>
        <div class="mb-4 text-center">
            <a href="/add-kecelakaan-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
            <a href="/update-kecelakaan-jagorawi.html" class="btn btn-warning">Update Data</a>
            <button class="btn btn-danger" onclick="showDeleteModalKecelakaan()">Hapus Data</button>
            <button class="btn btn-success" id="export-buttonKecelakaan" class="btn btn-primary mb-3">Export to Excel</button>
        </div>


        <!-- Modal Konfirmasi Hapus -->
        <div class="modal fade" id="deleteModalKecelakaan" tabindex="-1" aria-labelledby="deleteModalKecelakaan" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabelKecelakaan">Konfirmasi Penghapusan</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                    </div>
            <div class="modal-body">
                Apakah Anda yakin ingin menghapus data ini?
                <form id="deleteForm">
                    <div class="form-group">
                        <label for="kecelakaan_kerja_id">Masukkan ID/No data:</label>
                        <input type="number" class="form-control" id="kecelakaan_kerja_id" placeholder="Masukkan ID atau No data yang ingin dihapus">
                    </div>
                </form>
            </div>
                    <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-danger" onclick="deleteKecelakaan()">Hapus</button>
                    </div>
                </div>
            </div>
        </div>

    
        <table id="kecelakaan-kerja-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Tanggal</th>
                    <th>NIK</th>
                    <th>Nama</th>
                    <th>Jabatan</th>
                    <th>Ruas</th>
                    <th>Kronologis</th>
                    <th>Kategori Kecelakaan</th>
                    <th>Tindak Lanjut</th>
                    <th>Perawatan di RS</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data kecelakaan kerja akan diisi oleh script -->
            </tbody>
        </table>

       <!-- Rekap Data Kejadian Darurat Table -->
        <h2 id="kejadiannKerja" class="text-center">Rekap Data Kejadian Darurat JAGORAWI</h2>
        <div class="mb-4 text-center">
            <a href="/add-kejadian-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
            <a href="/update-kejadian-jagorawi.html" class="btn btn-warning">Update Data</a>
            <button class="btn btn-danger" onclick="showDeleteModalKejadian()">Hapus Data</button>
            <button class="btn btn-success" id="export-buttonKejadian" class="btn btn-primary mb-3">Export to Excel</button>
        </div>

        <table id="kejadian-kerja-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Kejadian Darurat</th>
                    <th>Lokasi</th>
                    <th>Kronologi Kejadian</th>
                    <th>Tindak Lanjut</th>
                    <th>Evidence</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data kecelakaan kerja akan diisi oleh script -->
            </tbody>
        </table>

<!-- Keterangan setelah tabel -->
<div class="keterangan">
    <h4>Keterangan:</h4>
    <ul>
        <li>Konsleting listrik yang mengakibatkan timbulnya bahaya seperti terdapat percikan api atau konsleting listrik yang menyebabkan padamnya aliran listrik sehingga mengganggu proses kerja.</li>
        <li>Banjir yang dapat menghambat kelancaran proses kerja dan terjadi di sekitar area kerja operasional atau non operasional.</li>
        <li>Kebakaran yang terjadi di sekitar area kerja operasional atau non operasional.</li>
        <li>Kerusakan pada area sekitar tempat kerja seperti contoh kerusakan pada bagian buhul-buhul gerbang yang membahayakan dan dapat menimpa karyawan atau pengguna jalan yang melintas.</li>
        <li>Huru-hara yang terjadi di sekitar area kerja yang menyebabkan terhambatnya proses kerja.</li>
        <li>Dan lain-lain kejadian darurat yang menyebabkan bahaya di sekitar tempat area kerja.</li>
    </ul>
</div>



    </div>


 
    <script>
        function showDeleteModalData() {
            $('#deleteModal').modal('show'); // Tampilkan modal pop-up
        }
        
        function deleteData() {
            const no = document.getElementById('no').value; // Ambil ID dari input modal
        
            if (!no) {
                alert("Mohon masukkan ID atau No data yang ingin dihapus.");
                return;
            }
        
            // Gunakan Axios untuk mengirim permintaan hapus
            axios.delete(`/deletedatajagorawi`, { 
                data: { no: no } // Mengirimkan data ID untuk dihapus
            })
            .then(function (response) {
                alert("Data berhasil dihapus.");
                // Refresh tabel atau hapus baris dari DOM
                location.reload();
            })
            .catch(function (error) {
                alert("Terjadi kesalahan saat menghapus data.");
                console.error(error);
            });
        
            // Tutup modal setelah penghapusan
            $('#deleteModal').modal('hide');
        }
    </script>


    <script>
        function showDeleteModalData() {
            $('#deleteModal').modal('show'); // Tampilkan modal pop-up
        }
        
        function deleteData() {
            const no = document.getElementById('no').value; // Ambil ID dari input modal
        
            if (!no) {
                alert("Mohon masukkan ID atau No data yang ingin dihapus.");
                return;
            }
        
            // Gunakan Axios untuk mengirim permintaan hapus
            axios.delete(`/deletedatajagorawi`, { 
                data: { no: no } // Mengirimkan data ID untuk dihapus
            })
            .then(function (response) {
                alert("Data berhasil dihapus.");
                // Refresh tabel atau hapus baris dari DOM
                location.reload();
            })
            .catch(function (error) {
                alert("Terjadi kesalahan saat menghapus data.");
                console.error(error);
            });
        
            // Tutup modal setelah penghapusan
            $('#deleteModal').modal('hide');
        }
    </script>

<script>
    function showDeleteModalPersonel() {
        $('#deleteModalPersonel').modal('show'); // Tampilkan modal pop-up
    }
    
    function deletePersonel() {
        const personel_k3_id = document.getElementById('personel_k3_id').value; // Ambil ID dari input modal
    
        if (!personel_k3_id) {
            alert("Mohon masukkan ID atau No data yang ingin dihapus.");
            return;
        }
    
        // Gunakan Axios untuk mengirim permintaan hapus
        axios.delete(`/deletepersoneljagorawi`, { 
            data: { personel_k3_id: personel_k3_id } // Mengirimkan data ID untuk dihapus
        })
        .then(function (response) {
            alert("Data berhasil dihapus.");
            // Refresh tabel atau hapus baris dari DOM
            location.reload();
        })
        .catch(function (error) {
            alert("Terjadi kesalahan saat menghapus data.");
            console.error(error);
        });
    
        // Tutup modal setelah penghapusan
        $('#deleteModal').modal('hide');
    }
</script>


<script>
    function showDeleteModalKecelakaan() {
        $('#deleteModalKecelakaan').modal('show'); // Tampilkan modal pop-up
    }
    
    function deleteKecelakaan() {
        const kecelakaan_kerja_id = document.getElementById('kecelakaan_kerja_id').value; // Ambil ID dari input modal
    
        if (!kecelakaan_kerja_id) {
            alert("Mohon masukkan ID atau No data yang ingin dihapus.");
            return;
        }
    
        // Gunakan Axios untuk mengirim permintaan hapus
        axios.delete(`/deletekecelakaanjagorawi`, { 
            data: { kecelakaan_kerja_id: kecelakaan_kerja_id } // Mengirimkan data ID untuk dihapus
        })
        .then(function (response) {
            alert("Data berhasil dihapus.");
            // Refresh tabel atau hapus baris dari DOM
            location.reload();
        })
        .catch(function (error) {
            alert("Terjadi kesalahan saat menghapus data.");
            console.error(error);
        });
    
        // Tutup modal setelah penghapusan
        $('#deleteModal').modal('hide');
    }
</script>


    <script>
        document.getElementById('export-button').addEventListener('click', function() {
            // Ambil data tabel
            var table = document.getElementById('data-table');
            var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    
            // Ekspor ke file Excel
            XLSX.writeFile(wb, 'rekap_data_k3.xlsx');
        });
    </script>

    <script>
        document.getElementById('export-buttonPersonel').addEventListener('click', function() {
            // Ambil data tabel
            var table = document.getElementById('personel-k3-table');
            var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    
            // Ekspor ke file Excel
            XLSX.writeFile(wb, 'rekap_personel_k3.xlsx');
        });
    </script>

    <script>
        document.getElementById('export-buttonKecelakaan').addEventListener('click', function() {
            // Ambil data tabel
            var table = document.getElementById('kecelakaan-kerja-table');
            var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    
            // Ekspor ke file Excel
            XLSX.writeFile(wb, 'rekap_kecelakaan_k3.xlsx');
        });
    </script>

        <script>
        document.getElementById('export-buttonKejadian').addEventListener('click', function() {
            // Ambil data tabel
            var table = document.getElementById('kejadian-kerja-table');
            var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    
            // Ekspor ke file Excel
            XLSX.writeFile(wb, 'rekap_kejadian_kerja.xlsx');
        });
    </script>



    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Your custom script -->
    <script src="script-jagorawi.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>


</body>
</html>
